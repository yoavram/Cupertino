\documentclass[9pt, a4paper, twocolumn]{extarticle}   	% use "amsart" instead of "article" for AMSLaTeX format
\usepackage[margin=1in]{geometry}                		% See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   		% ... or a4paper or a5paper or ... 
%\geometry{landscape}                		% Activate for rotated page geometry
%\usepackage[parfill]{parskip}    		% Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}				% Use pdf, png, jpg, or epsÂ§ with pdflatex; use eps in DVI mode
								% TeX will automatically convert eps --> pdf in pdflatex		
\usepackage{amssymb,amsmath,amsthm}
\usepackage{longtable,booktabs}
\PassOptionsToPackage{hyphens}{url} % url is loaded by hyperref
\usepackage[unicode=true]{hyperref}
\usepackage[auth-sc]{authblk}
\usepackage{titlesec}

\titleformat{\subsection}[runin]
  {\bf}{\thesection}{1em}{}
  
%SetFonts
% newtxtext+newtxmath
\usepackage{newtxtext} %loads helv for ss, txtt for tt
\usepackage{amsmath}
\usepackage[bigdelims]{newtxmath}
\usepackage[T1]{fontenc}
\usepackage{textcomp}
%SetFonts

% Yoav & Lee commands
\newcommand*{\tr}{^\intercal}
\let\vec\mathbf
\newcommand{\matrx}[1]{{\left[ \stackrel{}{#1}\right]}}
\newcommand{\diag}[1]{\mbox{diag}\matrx{#1}}
\newcommand{\goesto}{\rightarrow}
\newcommand{\dspfrac}[2]{\frac{\displaystyle #1}{\displaystyle #2} }
\newtheorem*{theorem}{Theorem}
\newtheorem*{corollary}{Corollary}
\newtheorem*{lemma}{Lemma}
\newtheorem*{remark}{Remark}
\newtheorem*{mfp}{Theorem: Mean Fitness Principle}
\newtheorem*{rvp}{Corollary: Reproductive Value Principle}
\newtheorem*{caswell}{Lemma: Caswell's Formula}
\newtheorem*{frv}{Fisher's reproductive values}
\renewcommand\qedsymbol{} % no square at end of proof

% NatBib
\usepackage[round,colon,authoryear]{natbib}

% Title page
\title{Necessity is the mother of genetic invention}

\author[a]{Yoav Ram}
\author[b]{Lee Altenberg}
\author[a]{Marcus W. Feldman}
\affil[a]{Department of Biology, Stanford University, Stanford, CA}
\affil[b]{Information and Computer Sciences, University of Hawai`i at M{\=a}noa, Honolulu, HI}

\date{\today} % Activate to display a given date or no date

% Document
\begin{document}
\maketitle

% Abstract
\begin{abstract}
Generation of variation is considered detrimental in well-adapted populations evolving under constant selection.
Therefore, in a constant environment, genetic modifiers that reduce the rate at which variation is generated by processes such as mutation and migration, succeed.
However, departures from this \emph{reduction principle} have been demonstrated.
Here we analyze a general model of evolution under constant selection where the rate at which variation is generated can depend on the fitness of the individual.
We find a general and simple result:
if individuals with below-average fitness increase the rate at which variation is generated, then the population mean fitness increases.
This principle applies to phenomena such as stress-induced mutagenesis, condition-dependent dispersal and outcrossing,
and even to the famous proverb: \emph{"Necessity is the mother of genetic invention"}.
\end{abstract}

% Introduction
\section*{Introduction}

According to the \emph{reduction principle}, in populations that evolve near an equilibrium between natural selection and a process that generates variation (i.e. mutation, migration, or recombination), selection favors neutral modifiers that decrease the rate at which variation is generated. 

The \emph{reduction principle} was demonstrated for modifiers of the recombination~\citep{Feldman1972}, mutation, and migration~\citep{Liberman1986a}, and dispersal rates~\citep{Altenberg1987}.
These separate principles were recently unified by~\citet{Altenberg2017}

The assumptions and conditions for the validity of the \emph{unified reduction principle} by neutral genetic modifiers are~\citep{Altenberg2017}:
(i) effectively infinite population size, (ii) constant-viability selection, (iii) a population at an equilibrium, and (iv) \emph{linear variation} -- the equal scaling of transition probabilities by the modifier.
A departure from the latter assumption occurs if two variation producing processes interact~\citep{Feldman1980,Altenberg2012}.
Departures from the \emph{reduction principle} have also been demonstrated when conditions (i)-(iii) are not met, see for example~\citet{Holsinger1986} and references therein.

Another departure from the \emph{linear variation} assumption of the \emph{reduction principle} for mutation rates involves a mechanism commonly called \emph{stress-induced mutagenesis}, in which the mutation rate increases in individuals with poor fitness.
\citet{Ram2012} demonstrated that modifiers that increase the mutation rate of individuals with below-average fitness actually \textbf{increase} the population mean fitness, rather than decrease it.
Their analysis assumed an infinite population size and constant-viability selection, such that the only departure from the \emph{reduction principle} assumptions is due to the differential effect the modifier has on different genotypes.
\citet{Ram2012} stated that their result represents a departure from the \emph{reduction principle}, but did not explain this departure.
Their analysis was specific to a model that classified individuals by the number of mutant genes in their genotype, similar to those of~\citet{Kimura1966} and~\citet{Haigh1978}. 

Here, we present a general evolutionary model where the rate at which variation is generated depends on the type of individual, and specifically on the its fitness.
Our result shows that low fitness individuals should produce more variation than high fitness individuals.

% Model
\section*{The Models}

\subsection*{General model.}
Consider a large haploid population with an arbitrary (possibly infinite) set of types $A_1, A_2, \ldots$.
The change in the frequencies of these types is described by the transformation $f \to f'$: 
\begin{equation}\label{eq:model}
\bar{\omega} f' = (I-C+MC)D f,
\end{equation}
where $f_k$ is the frequency of type $A_k$ ($f=(f_1, f_2, \ldots)$ is a stochastic vector: $\sum_k{f_k} = 1$);
$C_k$ is the probability that an individual of type $A_k$ will transition to another type ($C$ is a diagonal non-negative matrix with diagonal elements $C_k$);
$M_{i,j}$ is the transition probability from type $A_j$ to type $A_i$ given that an individual of type $A_j$ is transitioning ($M$ is a column-stochastic matrix: $\sum_j {M_{i,j}} = 1$ for any column \emph{j}); 
$D_k$ is the relative fitness of type $A_k$ ($D$ is a diagonal matrix with diagonal elements $D_k$, where we can assume $0 < D_k \le 1$, i.e., fitness values are relative to the fitness of the fittest type); 
$I$ is the identity matrix;
and $\bar{\omega}$ is a normalizing factor such that $\sum_k{f'_k}=1$ and is equal to the population mean fitness (see~\nameref{sec:AppA}).

The types $A_k$ can represent a single or multiple genetic loci or non-genetic traits.
Importantly, type transmission is vertical and uni-parental (the type is transmitted from a single parent to the offspring), independent of the frequencies of the other types, and is fully described by the matrix $M$. Specifically, transmission infidelity causes type transitions.
Therefore, this model precludes processes such as recombination, social learning, sexual outcrossing, and any horizontal or oblique transmission, as these processes are frequency-dependent~\cite[pg.~54]{Cavalli-Sforza1981}.

Transition between types is determined by a combination of two effects:
(i) the probability to transition \emph{out} of type $A_k$ is determined by $C_k$;
(ii) given a transition out of type $A_i$, the distribution of the destination types $A_j$ is given by $M_{j,i}$ (note the index order).
We focus on a modifier that has no direct effect on fitness and whose sole function is to determine the rate of transition out of the different types ($C_k$).
Importantly, this modifier can determine different rates for different types; that is, $C_j \ne C_i$ for some $i,j$. The case $C_j = C_j$ for all $i,j$ is covered by the \emph{reduction principle}, see~\citet{Altenberg2017}.

In the following section we present three particular examples of this model for the modification of mutation, migration, and learning.

\subsection*{Mutation modification model 1.}

Here we consider a large population of haploids and a trait determined by a major locus with $n$ possible alleles $A_1, A_2, ..., A_n$.
Linked to to this locus is a modifier locus that determines the mutation rates $\mu_k$ of individuals with allele $A_k$.
Specifically, with probability $1-\mu_k$, the allele $A_k$ does not mutate, and with probability $\frac{\mu_k}{n-1}$, the allele $A_k$ mutates to $A_j$ for any $j \ne k$.
This is an extension of a model studied by~\citet{Altenberg2017}, that allows for the mutation rate of an individual, $\mu_k$, to depend on the identity of the allele $A_k$.

Let the frequency of $A_k$ in the present generation be $f_k$ with $f_k \ge 0$ and $\sum_k{f_k}=1$.
Then after selection and mutation, $f'_k$ in the next generation is given by
\begin{equation}
f_k' = (1 - \mu_k) \frac{w_k}{\bar{w}} f_k + \frac{1}{n-1} \sum_{k \ne j}{\mu_j \frac{w_j}{\bar{w}} x_j},
\label{eq:mutation_model_1}
\end{equation}
for all $k=1,2,\ldots,n$, where $\bar{w} = \sum_{k=1}^{n}{w_k f_k}$ is the population mean fitness.

This model can be rephrased in terms of the general model: 
Eq.~\ref{eq:mutation_model_1} is equivalent to Eq.~\ref{eq:model} if we define
\begin{equation} 
C_k = \mu_k, \quad
D_k = w_k, \quad
M_{i,j} = \begin{cases}
\frac{1}{n-1}, & i \ne j \\
0, & i=j
\end{cases}.
\end{equation}

\subsection*{Mutation modification model 2.}

Here, we consider a large population of haploids in which individuals with genotype $A_k$ are characterized by the number $k$ of deleterious or mutant alleles in their genotype.
A modifier locus then determines the probability $m_k$ that a mutation occurs in individuals with $k$ mutant alleles.
In this case, we assume a low mutation rate $m_k$ such that two mutations are unlikely to occur in the same individual in one generation.
When a mutation occurs it is \emph{deleterious} with probability $\delta$, generating a new mutant allele and moving the individual from $A_k$ to $A_{k+1}$, or it is beneficial with probability $\beta$, moving the individual from $A_k$ to $A_{k-1}$.
Note that such beneficial mutations can be either compensatory or back-mutations, and that mutations are neutral with probability $1-\delta-\beta$.
This model has been analyzed by~\citet{Ram2012}.

Let the frequency of $A_k$ in the present generation be $f_k$ such that $f_k \ge 0$ and $\sum_k{f_k}=1$.
Then after selection and mutation $\vec{f'}$ in the next generation is given by
\begin{equation}
f_0' = (1 - \delta m_0) \frac{w_0}{\bar{w}} f_0 + \beta m_{1} \frac{w_{1}}{\bar{w}} f_{1},
\end{equation}
and
\begin{multline}
f_k' = (1 - m_k(\delta+\beta)) \frac{w_k}{\bar{w}} f_k + \\
\delta m_{k-1} \frac{w_{k-1}}{\bar{w}} f_{k-1} + \beta m_{k+1} \frac{w_{k+1}}{\bar{w}} f_{k+1},
\label{eq:mutation_model_2}
\end{multline}
for all $k=1,2,\ldots$, where $w_k$ is the fitness of an individual with $k$ mutant alleles and $\bar{w} = \sum_{k \ge 0}{w_k f_k}$ is the population mean fitness.

To rephrase this model in the terms of the general model, we define

\begin{equation}
C_k = m_k, \quad
D_k = w_k,
%M_{i,j} = \begin{cases}
%\beta, & i = j-1 \\
%1-\beta-\delta, & i = j \\
%\delta, & i = j+1 \\
%1-\delta, & i=j=0 \\
%0, & \text{otherwise}
%\end{cases}
\end{equation}
and
\begin{equation}
M_{i,j} = \begin{bmatrix}
1-\delta & \beta & 0 &  \cdots \\
\delta & 1-\delta-\beta & \beta &  \ddots \\
0 & \delta & 1-\delta-\beta & \ddots \\
\vdots & \ddots & \ddots & \ddots 
\end{bmatrix}
\end{equation}
so that Eq.~\ref{eq:mutation_model_2} is equivalent to Eq.~\ref{eq:model}.


\subsection*{Migration modification model.}

Here we assume a large population of haploids that occupies two demes and a modifier locus that determine the migration rates between the demes, $m_k$. 
Let the fitness of genotypes $A_k$ be $w_k$ in deme 1 and $u_k$ in deme 2 for $k=1,2,\ldots,n$.
Let the frequencies of $A_k$ in deme 1 be $x_k$ and in deme 2 $y_k$ for $k=1,2,\ldots,n$ with $x_k \ge 0$, $y_k \ge 0$, $\sum_{k=1}^{n}{x_k} = 1$. and $\sum_{k=1}^{n}{y_k} = 1$.

Then following selection and migration, after one generation the new frequencies $x_k'$ and $y_k'$ are given by
\begin{align}
x_k' = (1-m_k) \frac{w_k}{\bar{w}} x_k + m_k \frac{u_k}{\bar{u}} y_k \\
y_k' = m_k \frac{w_k}{\bar{w}} x_k + (1 - m_k) \frac{u_k}{\bar{u}} y_k
\end{align}
for $k=1,2,\ldots,n$, where $\bar{w} = \sum_{k \ge 0}{w_k x_k}$ and $\bar{u} = \sum_{k \ge 0}{u_k y_k}$ is the population mean fitness in deme 1 and 2, respectively.
This is an extension of a model presented by~\citet{Altenberg2017}, allowing for the migration rate of an individual, $m_k$, to depend on the identity of the allele $A_k$.

To rephrase this model in terms of the general model, we define
\begin{equation}
\begin{aligned}
f = (x_1, \ldots, x_n, y_1, \ldots, y_n)\tr, \\
C = diag[m_1, \ldots, m_n, m_1, \ldots, m_n], \\
D = diag[w_1, \ldots, w_n, u_1, \ldots, u_n], \\
M = \begin{bmatrix}
0 & I_n \\
I_n & 0
\end{bmatrix}
\end{aligned}
\end{equation}
where $I_n$ is the n-by-n identity matrix.

% Results
\section*{Results}

% Mean fitness principle
With the equilibrium of the frequency vector $f$ in Eq.~\ref{eq:model} as $v$ and the stable population mean fitness as $\bar{\omega}^*$, then
\begin{equation}\label{eq:model_equilibrium}
\bar{\omega}^* v = (I-C+MC)D v
\end{equation}

The following theorem presents a \emph{mean fitness principle} for the
sensitivity of the stable population mean fitness $\bar{\omega}^*$ to changes
in $C_k$ the probability for transition out of $A_k$.

\begin{mfp}
Let $\bar{\omega}^*$ be the leading eigenvalue of $(I-C+MC)D$, $u$ and $v$ be the corresponding left and right eigenvectors, and $[M]_k$ the $k$-th column of $M$. Then
\begin{equation}\label{eq:theorem}
\frac{\partial \bar{\omega}^*}{\partial C_k} = 
\frac{u_k v_k}{C_k} (\bar{\omega}^* - D_k),
\end{equation}
or in simpler terms,
\begin{equation}
sign\frac{\partial \bar{\omega}^*}{\partial C_k} = 
sign(\bar{\omega}^* - D_k), 
\end{equation}
and therefore increased transition from type $k$ will increase the stable population mean fitness if and only if the fitness of type $k$ is below the stable population mean fitness.
\end{mfp}

\begin{proof}
By the \emph{Perron-Frobenius theorem}~\cite[Appendix~A]{Otto2007},
$\bar{\omega}^*$ is the leading real positive eigenvalue of $(I-C+MC)D$,
and the corresponding left and right eigenvectors $u$ and $v$ are both non-negative and uniquely defined by $\sum_k{v_k} = 1$ and $\sum_k{u_k v_k} = 1$.

Using \emph{Caswell's formula} (Eq.~\ref{eq:Caswells_formula} in~\nameref{sec:AppB}),
\begin{equation}
\frac{\partial \bar{\omega}^*}{\partial C_k} = 
u\tr \frac{\partial (I-C+MC)D}{\partial C_k} v.
\end{equation}

Let $e_k$ and $e\tr_k$ be the column and row vectors with 1 at position $k$ and 0 elsewhere, $Z_k = e_k e\tr_k$ the matrix with 1 at position $(k,k)$ and 0 elsewhere, and $[M]_k$ the $k$-th column of $M$.

Then,
\begin{equation}\label{eq:theorem_intermediate}
\begin{aligned}
u\tr \frac{\partial (I-C+MC)D}{\partial C_k} v = 
u\tr (0 - Z_k + M Z_k)D v = \\
-v_k u_k D_k + v_k D_k u\tr[M]_k = \\
v_k D_k (u\tr[M]_k - u_k). 
\end{aligned}
\end{equation}

The corresponding equation to Eq.~\ref{eq:model_equilibrium} for the left
eigenvector $u$ is 
\begin{equation}
u\tr \bar{\omega}^* = u\tr (I - C + MC) D,
\end{equation}
which gives us a relation between $\bar{\omega}^*$ and the $k$
element of $u$:
\begin{equation}
u_k \bar{\omega}^* = (1-C_k) D_k u_k + C_k D_k u\tr [M]_k.
\end{equation}
Multiplying both sides by $v_k$ (which is positive if $D_k>0$) and rearranging, we get 
\begin{equation}
\frac{u_k v_k}{C_k} (\bar{\omega}^* - D_k) = v_k D_k(u\tr [M]_k - u_k).
\end{equation}
Plugging this in Eq.~\ref{eq:theorem_intermediate} yields:
\begin{equation}
\frac{\partial \bar{\omega}^*}{\partial C_k} = 
\frac{u_k v_k}{C_k} (\bar{\omega}^* - D_k).
\end{equation}
Finally, note that $u_k, v_k, C_k \ge 0$ and therefore
\begin{equation}
sign \frac{\partial \bar{\omega}^*}{\partial C_k} = 
sign (\bar{\omega}^* - D_k),
\end{equation}
which completes the proof.
\end{proof}

Note that if the modifier has the same effect on all types (i.e.,
$C_k = \alpha$ for all $k$) then Eq.~\ref{eq:model_equilibrium}
becomes $\bar{\omega}^* v = ((1-\alpha)I + \alpha M)Dv$,
and the \emph{unified reduction principle} is in effect~\cite[eqs. 65, 72]{Altenberg2017}.
Therefore, we can expect modifiers that reduce $\alpha$ to be favored by natural selection.
Indeed, setting $C = \alpha I$ in Eq.~\ref{eq:model_equilibrium} and proceeding as in the above proof, we get
$$
\frac{\partial \bar{\omega}^*}{\partial \alpha} = 
\bar{\omega}^* - 1 \le 0,
$$
because $\bar{\omega}^* = \sum_i{v_i D_i}$ (see~\nameref{sec:AppA}) and $D_i \le 1$ for all $i$.

% Reproductive value principle

An interesting intermediate result in Eq.~\ref{eq:theorem_intermediate} is

\begin{equation}
\begin{aligned}
\frac{\partial \bar{\omega}^*}{\partial C_k} = 
v_k D_k (u\tr[M]_k - u_k) = \\
D_k (\sum_i{u_i M_{i,k} v_k} - u_k v_k).
\end{aligned}
\end{equation}
Here, $u_k$ can be regarded as the \emph{reproductive value} of type $k$ (see~\nameref{sec:AppC}), which gives the relative contribution of type $k$ to the long-term population.
Consequently, $u_k v_k$ is the \emph{ancestor frequency} \citep{Hermisson2002} of type $k$, which is the fraction of the equilibrium population descended from type $k$.
The sum $\sum_i{u_i M_{i,k} v_k}$ can be similarly interpreted as the fraction of the equilibrium population descended from individuals that transitioned from type $k$ to another type (via the $k$ column of the transition matrix $M$).

Given $0 < D_k \le 1$, from Eq.~\ref{eq:theorem_intermediate} we can get the following corollary.

\begin{rvp}
In the notation of the theorem,
\begin{equation}
sign \frac{\partial \bar{\omega}^*}{\partial C_k} = 
sign (u\tr [M]_k - u_k),
\end{equation}
and therefore increased transition out of type $k$ will increase the stable population mean fitness if and only if the fraction of the population descended from type $k$ is expected to increase due to a transition to another type. 
\end{rvp}

We turn our attention to a modifier that concurrently controls the transition out of a subset of types, $K$.
For example, \citet[Appendix~B]{Ram2012} considered individuals that are grouped by the number of their accumulated deleterious mutations, $k$, and a modifier that regulates the mutation rates in individuals with at least $\pi$ deleterious mutations.

Similarly, if the transition rates are controlled by a threshold rule 
\begin{equation}
C_k = \begin{cases}
\tau, & k \in K \\
1, & k \not\in K
\end{cases},
\end{equation}
then the sensitivity of the stable population mean fitness to changes in the
rate of transition out of types $K$ is
\begin{equation}
\begin{aligned}
\frac{\partial \bar{\omega}^*}{\partial \tau} = 
u\tr \Big( \sum_{k \in \mathbb{K{}}}{\frac{\partial (I - C + MC)D}{\partial \tau}} \Big) v = \\
\frac{1}{\tau} \sum_{k \in \mathbb{K}}{u_k v_k (\bar{\omega}^* - D_k)}.
\end{aligned}
\end{equation}

\textbf{TODO} summarize result in words.

% Discussion
\section*{Discussion}
\textbf{TODO}: Departure from the \emph{reduction principle}

Eq.~\ref{eq:theorem} is a generalization of a result from \citet[Eq.~4]{Ram2012}.
Translated to the notation presented here, \citeauthor{Ram2012} modeled the accumulation of deleterious mutations in a population at the mutation-selection balance, assuming no more than one mutation occurs per individual per generation... \textbf{TODO} continue this...

Using Eq.~\ref{eq:Caswells_formula} in \nameref{sec:AppB} and a recursion on the ratios of the reproductive values \cite[see][eqs.~A5-6]{Ram2012}, they concluded that at the mutation-selection balance, if individuals with below-average fitness ($D_k < \bar{\omega}^*$) increase their mutation rate, then the population mean fitness will increase.

% Conclusions
\subsection*{Conclusions}

\textbf{TODO}

\section*{Appendices}
% Appendix A: mean fitness
\subsection*{Appendix A}\label{sec:AppA}
\textbf{TODO} reference to Fisher 1930 or Fisher 1958 (Caswell 1978 cites the latter in pg. 217 just above eq. 4).

\begin{lemma}
The normalizing factor $\bar{\omega}$ in Eq.~\ref{eq:model} is the population mean fitness
\begin{equation}
\bar{\omega} = \sum_k{f_k D_k}.
\end{equation}
\end{lemma}

\begin{proof}
By definition, the normalizing factor $\bar{\omega}$ ensures that $\sum_k{f'_k}=1$.
Denote $e = (1, ..., 1)$ the vector with ones at all positions and rewrite $e\tr f' = 1$.
Therefore, 
\begin{multline}\label{eq:mean_fitness}
\bar{\omega} = 
\bar{\omega} e\tr f' = 
e\tr (I - C + M C) D f = \\
(e\tr I - e\tr C + e\tr M C) D f = \\
(e\tr - e\tr C + e\tr C) D f = \\
e\tr D f = 
\diag{D} f = 
\sum_k{f_k D_k},
\end{multline}
using the fact that $e\tr M = e\tr$ and $e\tr I = e\tr$ because $M$ and $I$ are stochastic matrices.
\end{proof}

Note that this lemma also ensures that the stable population mean fitness $\bar{\omega}^*=\sum_k{v_k D_k},$ is the leading eigenvalue of $(I - C + M C) D$; see Eq.~\ref{eq:model_equilibrium} and the \emph{Perron-Frobenius theorem}~\cite[Appendix~A]{Otto2007}.

% Appendix B: Caswell
\subsection*{Appendix B}\label{sec:AppB}

\citet{Caswell1978} gave a \emph{formula for the sensitivity of the population growth rate to changes in life history parameters}.
In this formula, the \emph{population growth rate} is the leading eigenvalue of the population transformation matrix $T$, the \emph{life history parameters} are elements of $T$, and the \emph{sensitivity} is the derivative of the former with respect to the latter.
This is a useful formula~\citep{Caswell1978,Hermisson2002,Ram2012}, and therefore we reproduce it here.

\begin{caswell}
Let $T$ be a non-negative matrix with leading eigenvalue $\lambda$ and left and right eigenvectors $u$ and $v$ such that $\sum{v_k}=1$ and $u\tr v = \sum{u_k v_k} = 1$.
Then the sensitivity of $\lambda$ to changes in any element $t$ of the matrix $T$ is
\begin{equation}\label{eq:Caswells_formula}
\frac{\partial \lambda}{\partial t} = 
u\tr \frac{\partial T}{\partial t} v
\end{equation}
\end{caswell}

\begin{proof} 
Using the lemma assumptions,
$\lambda = \lambda u\tr v = u\tr \lambda v = u\tr T v$ and differentiating both sides we get $\partial \lambda = \partial (u\tr T v)$.
Using the product rule (once in each direction),

\begin{multline}
\partial (u\tr T v) = 
\partial u\tr T v + u\tr \partial T v + u\tr T \partial v = \\
u\tr \partial T v + \partial u\tr \lambda v  + \lambda u\tr \partial v = \\
u\tr \partial T v + \lambda(\partial u\tr v  + u\tr \partial v) = \\
u\tr \partial T v + \lambda \partial(u\tr v).
\end{multline}

Because $u\tr v = 1$,
we have $\partial (u\tr v) = 0$ and
$\partial \lambda = u\tr \partial T v$.
\end{proof}

% Appendix C: Fisher's reproductive value
\subsection*{Appendix C}\label{sec:AppC}
\begin{frv}
Let $M$ be a stochastic matrix and $D$ be a diagonal matrix with positive diagonal elements. 
The elements of the left \emph{Perron} eigenvector $u$ of the matrix $MD$ can be regarded as \emph{Fisher's reproductive values}~\citep{Fisher1930,Grafen2006}.
\end{frv}

\emph{Fisher's reproductive values} can be understood as follows.
Consider the dynamics not of frequencies but of absolute population sizes such that the vector of the number of individuals of each type at time $t$ is $n(t)$ and $f_k(t) = n_k(t) / \sum_i{n_i(t)}$.
The dynamics are
\begin{equation}
n(t) = (MD)^t n(0).
\end{equation}

Let $n(k, t)$ be the vector when the initial population is a single individual of type $k$.
The dynamics are
\begin{equation}
n(k,t) = (MD)^t e_k,
\end{equation}
where $e_k$ is a vector with 1 at position $k$ and 0 elsewhere.

The total population size at time $t$ starting with type $k$ is then
\begin{equation}
N(k,t) = \sum_i{n_i(k,t)} = e\tr (MD)^t e_k.
\end{equation}

Now we can compare the sizes of populations based on what type they started
with:
\begin{equation}
\frac{N(j,t)}{N(k,t)} = \frac{e\tr (MD)^t e_j}{e\tr (MD)^t e_k}.
\end{equation}

Now write $MD$ in its Jordan canonical form 
\begin{equation}
A = V \Lambda U\tr,
\end{equation}
where $V$ is the matrix of right column eigenvectors of $MD$,
$U\tr$ is the matrix of left row eigenvectors of $MD$,
$V U\tr = U\tr V = I$, 
and $\Lambda$ is the diagonal matrix of eigenvalues of $A$ 
(for a non-generic set of matrices $M$, the geometric and algebraic multiplicities of the eigenvalues of $MD$ differ, and $\Lambda$ will not be a diagonal matrix, a case we can ignore).

Hence,
\begin{multline}
N(k, t) = 
e\tr (MD)^t e_k =
e\tr  (V \Lambda U\tr)^t e_k = \\
e\tr V \Lambda^t U\tr e_k.
\end{multline}

For the ratio, we can divide $\Lambda$ by $\lambda_1 = \rho(MD)$,
the spectral radius of $MD$:
\begin{multline}
\frac{N(j,t)}{N(k,t)} =
\frac{ e\tr V \Lambda^t U\tr e_j}{ e\tr V \Lambda^t U\tr e_k} = \\
\frac{ e\tr V \diag{1, \Big(\frac{\lambda_2}{\lambda_1}\Big)^t, \cdots} U\tr e_j} { e\tr V \diag{1,\Big(\frac{\lambda_2}{\lambda_1}\Big)^t, \cdots} U\tr e_k}.
\end{multline}

Now take the long termlimit $t \goesto \infty$.
By assumption, $MD$ is irreducible, so $\lambda_i < \lambda_1$ for all $i > 1$.
Therefore,
\begin{equation}
\lim_{t \goesto \infty} \Big( \frac{\lambda_k}{\lambda_1} \Big)^t = 0
\end{equation}
for all $k > 1$, and
\begin{equation}
\lim_{t \goesto \infty}\frac{N(j,t)}{N(k,t)} =
\frac{e\tr V (e_1 e_1\tr) U\tr e_j} { e\tr V (e_1 e_1\tr) U\tr e_k} = 
\frac{ e\tr v u_j} { e\tr v  u_k} =
\frac{u_j} {u_k}.
\end{equation}

The vector $u$ is the left \emph{Perron} eigenvector of $MD$, and $u_k$ is element $k$ of $u$.
This is why the value $u_k$ can be interpreted as the \emph{reproductive value} of type $i$: it is a weighting for the size of the population generated by a single individual of type $k$.

If we begin with a population at the equilibrium distribution $v$,
and ask what fraction of long-term descendants descended from type $k$ at that time,
we weight the equilibrium frequency $v_k$ by the reproductive value $u_k$, to get $u_k v_k$.
$\{u_k v_k\}_{k}$ is a probability distribution, since
\begin{equation}
\sum_k {u_k v_k} = u\tr v = 1.
\end{equation}
\citet{Hermisson2002} called this distribution the \emph{ancestor} or \emph{ancestral distribution}.

% Acknowledgements
{\small
\section*{Acknowledgements}

This manuscript was supported in part by the Stanford Center for Computational, Evolutionary and Human Genomics, and by the Morrison Institute for Population and Resources Studies, Stanford University.
}

\bibliographystyle{plainnat}
\bibliography{/Users/yoavram/Documents/library}

\end{document}  